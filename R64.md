# Домашнее задание к занятию "6.4. PostgreSQL"

## Задача 1

### Используя docker поднимите инстанс PostgreSQL (версию 13). Данные БД сохраните в volume:

docker-compose.yml:

```yaml
version: "3.3"
services:
  postgres:
    image: postgres:13
    ports:
      - "5432:5432"
    container_name: pdb
    environment:
      POSTGRES_USER: "admin"
      POSTGRES_PASSWORD: "test"
    volumes:
      - db:/var/lib/postgresql/data
    restart: always
volumes:
  db: {}
```


### Подключитесь к БД PostgreSQL используя `psql`:

```bash
docker exec -it pdb psql -Uadmin
```

Вывода списка БД:

`\l+` - с дополнительными деталями

Информация о всех подкючениях:

```sql
SELECT pid,datname,usename,application_name,client_hostname,client_port,backend_start,query_start,query,state FROM pg_stat_activity;
```

Если требовалась команда для подключения к БД:

`\c` 

Вывода списка таблиц:

`\dtS`

Можно использовать `\dtS+` - для вывода дополнительной информаии

Вывода описания содержимого таблиц:

`\dS pg_aggregate`

где `pg_aggregate` - пример имени таблицы

Выхода из `psql`:

`\q`

## Задача 2

### Используя `psql` создайте БД `test_database`:

#### Используя `psql` создайте БД `test_database`:

```sql
create database test_database;
```

Изучив backup выполнил еще одну команду:

```sql
create role postgres;
```

#### Приведите в ответе команду, которую вы использовали для вычисления и полученный результат:

Если в таблице окажется два и более поля с одинаковыми средними значениями, то можно воспользоваться следующим запросом: 

```sql
select attname, avg_width from pg_stats where tablename='orders' and avg_width in (select max(avg_width) from pg_stats where tablename='orders');
```

Если нам необходимо одно поле даже если их два и более с одинаковом средним, то более локаничный вариант:

```sql
select avg_width from pg_stats where tablename='orders' order by avg_width desc limit 1;
```

## Задача 3

### SQL-транзакция:

```sql

```

